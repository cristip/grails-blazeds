<html>
    <head>
        <title>BlazeDS Plugin 2.0 - Reference Documentation</title>
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" title="Style" charset="utf-8"/>
        <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    </head>
    <body class="body">
        <div id="header">
            <div class="images"><br/><br/>
                <a href="http://grails.org" target="_blank"><img alt="The Grails Framework" src="../img/grails.png" border="0"/></a>
                <span style="right:30px; top:20px; position:absolute;">
                    <a href="../index.html" target="_top">Frames</a> | <a href="index.html" target="_top">No Frames</a><br/><br/>
                    <a href="http://springsource.com" target="_blank"><img alt="SpringSource - A Division of VMware" src="../img/springsource-logo.png" border="0"/></a>
                </span>
            </div>
            <div class="message">blazeds</div>
            <h1>BlazeDS Plugin - Reference Documentation</h1>
            <p><strong>Authors:</strong> Sebastien Arbogast, Burt Beckwith</p>
            <p><strong>Version:</strong> 2.0</p>
            <em></em>
        </div>

        <div id="toc">
            <h2>Table of Contents</h2>
            <div class="tocItem" style="margin-left:0px"><a href="#1 Introduction to the BlazeDS Plugin">1 Introduction to the BlazeDS Plugin</a></div><div class="tocItem" style="margin-left:10px"><a href="#1.1 Getting Started">1.1 Getting Started</a></div><div class="tocItem" style="margin-left:0px"><a href="#2 Configuration">2 Configuration</a></div><div class="tocItem" style="margin-left:0px"><a href="#3 General Usage">3 General Usage</a></div>
        </div>
        <div id="content">
            <h1><a name="1 Introduction to the BlazeDS Plugin">1 Introduction to the BlazeDS Plugin</a></h1>The BlazeDS plugin makes it easier to build Grails-powered Rich Internet Applications using the <a href="http://opensource.adobe.com/wiki/display/blazeds/BlazeDS/" target="blank">Adobe BlazeDS</a> remoting and messaging framework, as well as the <a href="http://grails.org/plugin/spring-security-core" target="blank">Spring Security Core</a> plugin to secure your application. The plugin also adds support for lazy loading to make it easier to work with GORM and Hibernate.
<h2><a name="1.1 Getting Started">1.1 Getting Started</a></h2><h4>The first step is installing the plugin:</h4><p class="paragraph"/><div class="code"><pre>grails install&#45;plugin blazeds</pre></div><p class="paragraph"/>This will transtitively install the <a href="http://grails.org/plugin/spring-security-core" target="blank">Spring Security Core</a>, and <a href="http://grails.org/plugin/spring-security-acl" target="blank">Spring Security ACL</a> plugins. Refer to the documentation for these plugins for configuration options. At a minimum you'll need to run the <code>s2-quickstart</code> script to configure Spring Security Core, e.g.<p class="paragraph"/><div class="code"><pre>grails s2&#45;quickstart com.yourcompany.yourapp User Role</pre></div><p class="paragraph"/>The Spring Security ACL plugin has no required initialization steps.<p class="paragraph"/><h1><a name="2 Configuration">2 Configuration</a></h1>There are a few configuration options for the plugin.<p class="paragraph"/><table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">Property</strong></th><th><strong class="bold">Default</strong></th><th><strong class="bold">Meaning</strong></th></tr><tr class="table-odd"><td>grails.plugin.blazeds.defaultMessageChannels</td><td>none</td><td>a comma-delimited String listing the default messaging channels, e.g. <code>'my-streaming-amf,my-longpolling-amf,my-polling-amf'</code></td></tr><tr class="table-even"><td>grails.plugin.blazeds.defaultRemoteChannels</td><td>none</td><td>a comma-delimited String listing the default remoting channels, e.g. <code>'my-amf'</code></td></tr><tr class="table-odd"><td>grails.plugin.blazeds.converterNames</td><td>&#91;HibernateProxyConverter, PersistentCollectionConverterFactory, JpaNumericAutogeneratedIdConverter&#93;</td><td>a list of class names of converters used when serializing class instances to clients</td></tr><tr class="table-even"><td>grails.plugin.blazeds.proxyIgnoreProperties</td><td>'class', 'metaClass', 'hibernateLazyInitializer' plus all event names from <code>grails.persistence.Event</code></td><td>a list of property names to ignore when serializing class instances to clients</td></tr><tr class="table-odd"><td>grails.plugin.blazeds.disableOpenSessionInView</td><td><code>false</code></td><td>set to <code>true</code> to disable the Open Session in View filter</td></tr></table><p class="paragraph"/><h1><a name="3 General Usage">3 General Usage</a></h1><h4>Runtime configuration</h4><p class="paragraph"/>The plugin manages the configuration of BlazeDS. This includes configuring <code>flex.messaging.HttpFlexSession</code> as a listener in web.xml along with the <code>flex.rds.server.servlet.FrontEndServlet</code> servlet for use by Flash Builder. It also configures <code>/messagebroker/*</code> URLs to be intercepted and handled as BlazeDS requests.<p class="paragraph"/><h4>Data serialization</h4><p class="paragraph"/>There are a few options for configuring how class instances are serialized to clients. All of the standard BlazeDS rules apply, but having Hibernate in the mix complicates things because of lazy-loaded collections and many-to-one references.<p class="paragraph"/>By default an Open Session in View filter is registered unless this is disabled by setting <code>grails.plugin.blazeds.disableOpenSessionInView</code> to <code>true</code> in <code>Config.groovy</code>. This acts like the analagous interceptor that Grails registers for controller requests, starting and binding a thread-local Hibernate Session at the beginning of a BlazeDS request and flushing and closing it after the response is rendered. This allows you to not have to worry about lazy loading exceptions when using domain classes that refer to other lazy-loaded classes.<p class="paragraph"/>There's a significant performance concern here though since you can potentially render a very large object graph to the client when only a small amount of data is needed. One option is to use Data Transfer Objects (DTOs) that you create using data from persistent domain classes. This allow you to control exactly what data gets sent to your clients.<p class="paragraph"/>Another option is to use the data converters that the plugin registers for you by default. These include <a href="http://static.springsource.org/spring-flex/docs/1.5.x/javadoc-api/org/springframework/flex/core/io/HibernateProxyConverter.html" target="blank">HibernateProxyConverter</a> which sends a <code>null</code> value for any uninitialized many-to-one reference, and <a href="http://static.springsource.org/spring-flex/docs/1.5.x/javadoc-api/org/springframework/flex/core/io/PersistentCollectionConverterFactory.html" target="blank">PersistentCollectionConverterFactory</a> which does the same for uninitialized collections. You can explicitly initialize any required many-to-one references or collections using the <a href="http://docs.jboss.org/hibernate/stable/core/api/org/hibernate/Hibernate.html#initialize%28java.lang.Object%29" target="blank">org.hibernate.Hibernate.initialize()</a> method.<p class="paragraph"/>You can remove any of the configured converters (or add your own) by changing the value of <code>grails.plugin.blazeds.converterNames</code> in <code>Config.groovy</code>, which is &#91;'org.springframework.flex.core.io.HibernateProxyConverter, 'org.springframework'flex.core.io.PersistentCollectionConverterFactory', 'org.springframework.flex.core.io.JpaNumericAutogeneratedIdConverter'&#93; by default.<p class="paragraph"/><h4>Grails services as remote destinations</h4><p class="paragraph"/>It's simple to access a Grails service as a remote service from Flex - just annotate the service with the <code>org.springframework.flex.remoting.RemotingDestination</code> annotation. BlazeDS handles invoking method calls and marshalling parameters and return values for you.<p class="paragraph"/>One thing that's important to note is that although there is a <code>services-config.xml</code> configuration file (created when the BlazeDS plugin is installed) you probably won't need to make many changes there. In typical BlazeDS applications you would register remote services using XML, but Grails services are well suited as candidates for remote services.<p class="paragraph"/>The plugin also handles service reloading for you and re-registers recompiled annotated services as remoting destinations.<p class="paragraph"/><h4>Manual configuration</h4><p class="paragraph"/>You're not limited to using Grails services as the server-side implementation of remote services. You can use any class like you would in a non-Grails application, and the best place to configure this is in <code>grails-app/conf/spring/resources.groovy</code> using the BeanBuilder syntax equivalent of the Spring Flex XML configuration.<p class="paragraph"/>For example, this resources.groovy file contains four messaging destinations and two remoting destinations. Remoting destinations are configured like any other Spring bean, with the addition of a <code>flex.'remoting-destination'()</code> child element, optionally with configuration options. See the <a href="http://www.springsource.org/spring-flex" target="blank">Spring Flex</a> documentation for more information on what's available.<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> flex.management.jmx.MBeanServerGateway<p class="paragraph"/>beans = &#123;<p class="paragraph"/>   xmlns flex: 'http://www.springframework.org/schema/flex'<p class="paragraph"/>   flex.'message&#45;destination'(id: 'chat')
   flex.'message&#45;destination'(id: 'secured&#45;chat', 'send&#45;security&#45;constraint': 'trusted')
   flex.'message&#45;destination'(id: 'simple&#45;feed')
   flex.'message&#45;destination'(id: 'market&#45;feed', 'allow&#45;subtopics': <span class="java&#45;keyword">true</span>, 'subtopic&#45;separator': '.')<p class="paragraph"/>   securityHelper(Security3Helper) &#123;
      flex.'remoting&#45;destination'()
   &#125;<p class="paragraph"/>   RuntimeManagement(MBeanServerGateway) &#123;
      flex.'remoting&#45;destination'(channels: 'my&#45;amf, my&#45;secure&#45;amf')
   &#125;
&#125;</pre></div><p class="paragraph"/>
        </div>
        <div id="footer">
             
        </div>
    
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-16219500-1']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
</body>
</html>
